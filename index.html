<!DOCTYPE html>
<html>
<head>

<title>ConorCo Solutions Ltd.</title>

<style>
body {
	perspective: 1200px;
	perspective-origin: 50% 100px;
	height: 300px;
	margin: 50px;
}
.box {
	position: absolute;
	width: 0px;
	transform-style: preserve-3d;
}
.box > * {
	backface-visibility: hidden;
	position: absolute;
	text-align: center;
	transform-origin: top left;
}

.left	{ background: #f00; }
.right	{ background: #700; }
.front	{ background: #0f0; }
.back	{ background: #070; }
.top	{ background: #00f; }
.bottom	{ background: #77f; }
</style>

<script>
/* Chooses a random point inside a unit-sphere. (Not normalized to the surface.) */
function randSphere() {
	/* too slow */
	/*
	var phi = Math.random() * 2 * Math.PI;
	var costheta = Math.random() * 2 - 1;
	var theta = Math.acos(costheta);
	var x = Math.sin(theta) * Math.cos(phi);
	var y = Math.sin(theta) * Math.sin(phi);
	var z = costheta;
	return [x, y, z];
	*/

	/* non-deterministic runtime, but empirically faster */
	var x, y, z, mag;
	do {
		x = Math.random() * 2 - 1;
		y = Math.random() * 2 - 1;
		z = Math.random() * 2 - 1;
		mag = x*x + y*y + z*z;
	} while (mag >= 1);
	return [x, y, z];
}

function randRot3d(angle) {
	var vector = randSphere().join(', ');
	if (angle === undefined)
		angle = Math.random() / 2 + 'turn';
	return 'rotate3d('+vector+', '+angle+')';
}

function Box(l,w,h) {
	this.box = document.createElement('div');
	this.box.className = 'box';
	this.sides = {
		left: {w: l, h: h, xform: 'T3d(-W,-H,-L) RY(-90D)'},
		right: {w: l, h: h, xform: 'T3d(W,-H,L) RY(90D)'},
		front: {w: w, h: h, xform: 'T3d(-W,-H,L)'},
		back: {w: w, h: h, xform: 'T3d(W,-H,-L) RY(180D)'},
		top: {w: w, h: l, xform: 'T3d(-W,-H,-L) RX(90D)'},
		bottom: {w: w, h: l, xform: 'T3d(-W,H,L) RX(-90D)'},
	};
	for (name in this.sides) {
		var side = this.sides[name];

		side.canvas = document.createElement('div');
		//side.canvas = document.createElement('canvas');
		side.canvas.style.width = side.w+'px';
		side.canvas.style.height = side.h+'px';
		//side.canvas.width = side.w;
		//side.canvas.height = side.h;
		side.canvas.className = name;
		//side.ctx = side.canvas.getContext('2d');
		side.canvas.textContent = '['+name+']';

		function replaceMap(str, map) {
			for (s in map)
				str = str.replace(s, map[s]);
			return str;
		}

		if (side.xform) {
			side.canvas.style.transform = replaceMap(side.xform, {
				R: 'rotate',
				T: 'translate',
				D: 'deg',
				L: (l/2) + 'px',
				W: (w/2) + 'px',
				H: (h/2) + 'px',
			});
		}

		this.box.appendChild(side.canvas);
	}
}
Box.prototype.reorient = function() {
	this.baseTransformation = randRot3d();
	if (!this.box.style.transform)
		this.box.style.transform = this.baseTransformation;
};
Box.prototype.spin = function(hz) {
	var otherTransforms = '';
	[this.baseTransformation].forEach(function(x) {
		if (x) otherTransforms += ' ' + x;
	});
	var spin = this.box.animate([
		{transform: randRot3d('0turn') + otherTransforms},
		{transform: randRot3d('1turn') + otherTransforms}
	], {duration: 1000 / hz, iterations: Infinity});
	return spin;
};

addEventListener('click', function(e) {
	function randLWH() { return (Math.random() * 2 + 1) * 100; }
	var box = new Box(randLWH(), randLWH(), randLWH());

	box.box.style.left = e.clientX+'px';
	box.box.style.top = e.clientY+'px';

	var hz = (Math.random()/2 + Math.random()) * Math.random();

	box.reorient();
	box.spin(hz);

	document.body.appendChild(box.box);
});

</script>

</head>
<body>

<h1 style="text-align: center;">Coming soon!<sup>&trade;</sup></h1>

</body>
</html>
